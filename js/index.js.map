{"version":3,"sources":["src/_helpers.js","src/main.js"],"names":["debounce","fn","time","timeout","_this","this","_arguments","arguments","functionCall","apply","clearTimeout","setTimeout","mq","small","window","matchMedia","medium","large","childIndex","el","Array","from","parentNode","children","indexOf","getUrlParameter","name","replace","regex","results","RegExp","exec","location","search","decodeURIComponent","siteTitle","document","querySelector","cards","querySelectorAll","cardWrapper","getElementById","closeButton","cardDelay","projectCards","getProjectByUrl","filter","item","project","getProjectByElement","element","cardHeight","cardScale","gutter","calculateScale","matches","clientWidth","calculateDuration","distanceFromTop","getBoundingClientRect","top","duration","Math","abs","max","setWrapperHeight","wrapperHeight","length","style","height","concat","positionCard","card","index","header","hh","y","clientHeight","transform","renderNextLink","nextCard","undefined","nextProject","btnContainer","createElement","classList","add","body","appendChild","nextLink","innerHTML","href","link","addEventListener","event","preventDefault","lastCard","openCard","closeCard","fetchProjectInfo","fetch","then","response","text","content","catch","err","console","log","push","stateObj","history","pushState","transitionTime","bodyWrapper","transitionDuration","pageYOffset","bodyScrollLock","disableBodyScroll","remove","contains","scrollTop","enableBodyScroll","closeCurrentCard","currentCard","defaultHistoryState","title","replaceState","ProjectCard","getAttribute","setUpCards","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","Symbol","iterator","_step","next","done","value","newCard","return","resetCards","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","popStateHandler","state","delay","pageLoad","homeBtnHandler","e"],"mappings":"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","sourcesContent":["\nconst debounce = (fn, time) => {\n  let timeout;\n\n  return function() {\n    const functionCall = () => fn.apply(this, arguments);\n\n    clearTimeout(timeout);\n    timeout = setTimeout(functionCall, time);\n  };\n};\n\nconst mq = {\n  small:  window.matchMedia(\"(min-width: 400px)\"),\n  medium: window.matchMedia(\"(min-width: 700px)\"),\n  large:  window.matchMedia(\"(min-width: 1000px)\")\n};\n\nconst childIndex = (el) => Array.from(el.parentNode.children).indexOf(el);\n\nfunction getUrlParameter(name) {\n  name = name.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n  const regex = new RegExp('[\\\\?&]' + name + '=([^&#]*)');\n  const results = regex.exec(location.search);\n  return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n}\n","\nconst siteTitle = document.querySelector('.site-title');\nconst cards = document.querySelectorAll('.card');\nconst cardWrapper = document.getElementById('card-wrapper');\nconst closeButton = document.getElementById('close-project');\nconst cardDelay = 250;\nconst projectCards = [];\n\nconst getProjectByUrl = () =>\n  projectCards.filter(item => item.project === getUrlParameter('content'))[0];\n\nconst getProjectByElement = element =>\n  projectCards.filter(item => item.el === element)[0];\n\n\nlet cardHeight, cardScale, gutter;\n\nfunction calculateScale() {\n  cardHeight = mq.medium.matches ? 480\n             : mq.small.matches ? 360\n             : 300;\n\n  cardScale = mq.small.matches ? 0.95 : 0.925;\n  gutter = cardWrapper.clientWidth * (1 - cardScale)/2;\n}\n\nconst calculateDuration = element => {\n  const distanceFromTop = element.getBoundingClientRect().top;\n  const duration =  Math.abs(distanceFromTop) / 5 + 200;\n  return Math.max(duration, 300);\n}\n\nfunction setWrapperHeight() {\n  const wrapperHeight = cards.length * (cardHeight + gutter);\n  cardWrapper.style.height = `${wrapperHeight}px`;\n}\n\nfunction positionCard(card) {\n  // console.log('Positioning card');\n  const index = childIndex(card);\n  const header = document.getElementById('header');\n  const hh = header ? header.clientHeight : 0;\n  const y = hh + index * cardHeight;\n  card.style.transform = `scaleX(${cardScale}) translateY(${y + gutter * index}px)`;\n}\n\nfunction renderNextLink(project) {\n  const nextCard = cards[childIndex(project.el) + 1];\n  if (nextCard !== undefined) {\n    const nextProject = getProjectByElement(nextCard);\n\n    const btnContainer = document.createElement('div');\n    btnContainer.classList.add('btn-container');\n    project.body.appendChild(btnContainer);\n\n    const nextLink = document.createElement('a');\n    nextLink.classList.add('btn-next-project');\n    nextLink.innerHTML = 'Next Project';\n    nextLink.href = nextProject.link;\n\n    nextLink.addEventListener('click', event => {\n      event.preventDefault();\n      const lastCard = document.querySelector('.card.expanded');\n      openCard(nextProject, true, 500);\n      setTimeout(() => {\n        closeCard(lastCard);\n      }, 500);\n    });\n\n    btnContainer.appendChild(nextLink);\n  }\n}\n\nfunction fetchProjectInfo(card) {\n  // console.log('Fetching project info');\n  fetch(`./pages/${card.project}.html`).then((response) => {\n    return response.text();\n  }).then((content) => {\n    card.body.innerHTML += content;\n    renderNextLink(card);\n    setTimeout(() => {\n      card.el.classList.add('content-loaded');\n    }, 125);\n  }).catch((err) => {\n    console.log('Fetch Error', err);\n  });\n}\n\nfunction openCard(card, push, duration = null) {\n  // console.log('Opening card');\n  if (push) {\n    const stateObj = { content: card.project };\n    history.pushState(stateObj, 'project page', card.link);\n  }\n\n  const transitionTime = duration ? duration : calculateDuration(card.el);\n  const bodyWrapper = card.el.querySelector('.card-body--outer');\n  card.el.style.transitionDuration = `${transitionTime}ms`;\n  bodyWrapper.style.transitionDuration = `${transitionTime}ms`;\n\n  card.el.classList.add('expanded', 'anim-in');\n  card.el.style.transform = `scaleX(1) translateY(${window.pageYOffset}px)`;\n  card.el.style.top = `-${window.pageYOffset}px`;\n  bodyScrollLock.disableBodyScroll(card.el);\n  document.body.classList.add('card-open');\n\n  setTimeout(() => {\n    card.el.classList.remove('anim-in');\n    if (closeButton) {\n      closeButton.classList.add('visible');\n    }\n  }, cardDelay);\n  if (!card.el.classList.contains('content-loaded')) {\n    fetchProjectInfo(card);\n  }\n}\n\nfunction closeCard(card) {\n  if (closeButton) closeButton.classList.remove('visible');\n  card.scrollTop = 0;\n  card.classList.add('anim-out');\n  bodyScrollLock.enableBodyScroll(card);\n  positionCard(card);\n  setTimeout(() => {\n    card.classList.remove('expanded', 'anim-out');\n    card.style.top = `0`;\n    if (!document.querySelector('.card.expanded')) {\n      document.body.classList.remove('card-open');\n    }\n  }, cardDelay);\n}\n\nfunction closeCurrentCard() {\n  const currentCard = document.querySelector('.card.expanded');\n  if (currentCard) {\n    closeCard(currentCard);\n  }\n}\n\nfunction defaultHistoryState(push) {\n  const stateObj = { content: 'project index' };\n  if (push) {\n    history.pushState(stateObj, document.title, 'index.html');\n  } else {\n    history.replaceState(stateObj, document.title, 'index.html');\n  }\n}\n\nfunction ProjectCard(card) {\n  this.el = card;\n  this.header = card.querySelector('.card-header');\n  this.body = card.querySelector('.card-body--inner');\n  this.project = card.getAttribute('id');\n  this.link = this.header.getAttribute('href');\n\n  this.header.addEventListener('click', event => {\n    event.preventDefault();\n    if (!this.el.classList.contains('expanded')) {\n      openCard(this, true);\n    }\n  });\n\n}\n\nfunction setUpCards() {\n  // console.log('Setting up cards');\n  calculateScale();\n  setWrapperHeight();\n  if (!getUrlParameter('content')) {\n    defaultHistoryState();\n  }\n  for (let card of cards) {\n    let newCard = new ProjectCard(card);\n    projectCards.push(newCard);\n    positionCard(card);\n  }\n}\n\nfunction resetCards() {\n  calculateScale();\n  setWrapperHeight();\n  for (let card of cards) {\n    if (!card.classList.contains('expanded')) {\n      positionCard(card);\n    }\n  }\n}\n\nconst popStateHandler = event => {\n  // console.log('Popstate fired!');\n  if (event.state.content === 'project index') {\n    closeCurrentCard();\n  } else if (getUrlParameter('content')) {\n    closeCurrentCard();\n    let delay = document.body.classList.contains('card-open') ? 500 : 0;\n    const project = getProjectByUrl();\n    setTimeout(() => {\n      openCard(project, false, 500);\n    }, delay);\n  }\n};\n\nfunction pageLoad() {\n  if (window.location.search) {\n    const project = getProjectByUrl();\n    openCard(project, false);\n  }\n}\n\nfunction homeBtnHandler(e) {\n  e.preventDefault();\n  if (getUrlParameter('content') !== '') {\n    closeCurrentCard();\n    defaultHistoryState(true);\n  } else {\n    window.location = 'index.html';\n  }\n}\n\n\nsiteTitle.addEventListener('click', homeBtnHandler);\nwindow.addEventListener('popstate', popStateHandler);\nwindow.addEventListener('load', pageLoad);\n\nwindow.addEventListener('resize', debounce(() => {\n  resetCards();\n}, 100));\n\nsetUpCards();\nsetTimeout(() => {\n  cardWrapper.classList.add('visible');\n  cardWrapper.classList.remove('no-trans');\n}, cardDelay);\n"]}